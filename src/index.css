@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
@import './styles/theme.css';
body{ font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Konsekvent typografi fÃ¶r hela appen */
@layer base {
  h1, h2, h3, h4, h5, h6 {
    font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
    letter-spacing: -0.05em;
    font-weight: 700;
  }
}

@layer base {
  :root {
    --accent-green: #10b981;
    --accent-cyan: #06b6d4;
    --accent-blue: #3b82f6;
    --accent-red: #ef4444;
    --error-red: #E45855;
    /* Flowship tokens */
    --border-subtle: rgba(139,135,255,0.15);
    --panel-a: #1E293B;
    --panel-b: rgba(30,41,59,0.70);
    /* Primary purple for neon glow */
    --primary-purple: #8B5CF6;
    --primary-purple-rgb: 139, 92, 246;
  }
  
  /* Base styles for HTML, body and root - ensure black background */
  html, body {
    height: 100%;
    width: 100%;
    margin: 0;
    padding: 0;
    overflow-x: hidden; /* Prevent horizontal scrollbar */
    font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
  }

  /* Root container styles */
  #root {
    height: 100%;
    width: 100%;
    margin: 0;
    padding: 0;
    overflow-x: hidden; /* Prevent horizontal scrollbar */
    overflow-y: auto; /* Allow vertical scrolling */
    background-color: transparent; /* Allow root to be transparent against black body */
    position: relative;
    transform-style: preserve-3d; /* Force a stacking context */
    -webkit-transform-style: preserve-3d; /* For Safari */
    isolation: isolate; /* Create stacking context */
    max-width: 100vw;
    max-height: 100vh;
  }
  
  /* Ensure canvas elements can be seen */
  canvas.starfield-canvas {
    backface-visibility: visible;
    will-change: transform;
  }
}

@layer components {
  .goalInput {
    font-size: 0.85rem; /* Avoid @apply with arbitrary values */
    @apply px-4 py-2 border rounded-lg 
      focus:outline-none focus:ring-2 focus:ring-blue-500 
      dark:bg-gray-700 dark:border-gray-600 dark:text-white 
      dark:placeholder-gray-400 dark:focus:ring-blue-400
      disabled:bg-gray-100 dark:disabled:bg-gray-800 
      disabled:text-gray-500 dark:disabled:text-gray-400;
  }

  /* Unified mission input styling (used by Mission Board and Goal Panel) */
  .mission-input {
    font-size: 0.85rem; /* Avoid @apply with arbitrary values */
    @apply px-3.5 py-2.5 rounded-md border 
      bg-white/70 dark:bg-gray-700/60 
      text-gray-800 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400
      focus:outline-none focus:ring-2 focus:ring-violet-400 dark:focus:ring-violet-300
      disabled:opacity-60 disabled:cursor-not-allowed;
    border-color: rgba(139,135,255,0.30);
  }
  .dark .mission-input {
    border-color: rgba(139,135,255,0.28);
  }


  /* Neon glow variant for timer controls (keeps glass bg, removes border) */
  .panel-glass--neon {
    border: none;
    /* Multi-layer neon purple glow per style guide intent */
    box-shadow:
      0 0 0 2px rgba(var(--primary-purple-rgb), 0.45),
      0 0 14px rgba(var(--primary-purple-rgb), 0.55),
      0 0 28px rgba(var(--primary-purple-rgb), 0.35),
      0 0 56px rgba(var(--primary-purple-rgb), 0.25);
  }

  /* Premium glass cockpit wrapper for side panels */
  .panel-cockpit {
    /* Override base radius to match spec (16px) */
    border-radius: 16px;
    /* Subtle multi-layer glow + depth */
    box-shadow:
      inset 0 0 0 1px rgba(var(--primary-purple-rgb), 0.08),
      0 8px 24px rgba(0, 0, 0, 0.35),
      0 0 24px rgba(var(--primary-purple-rgb), 0.10);
    transition: box-shadow 250ms ease, transform 200ms ease;
  }

  .panel-cockpit:hover {
    box-shadow:
      inset 0 0 0 1px rgba(var(--primary-purple-rgb), 0.10),
      0 12px 28px rgba(0, 0, 0, 0.40),
      0 0 32px rgba(var(--primary-purple-rgb), 0.18);
    transform: translateY(-1px) scale(1.01);
  }

  /* Disable hover growth for specific panels (e.g., Session History) */
  .panel-cockpit.panel-static { 
    transition: none; 
  }
  .panel-cockpit.panel-static:hover {
    /* Keep default resting shadow and prevent transform */
    box-shadow:
      inset 0 0 0 1px rgba(var(--primary-purple-rgb), 0.08),
      0 8px 24px rgba(0, 0, 0, 0.35),
      0 0 24px rgba(var(--primary-purple-rgb), 0.10);
    transform: none;
  }

  .panel-cockpit:focus-within {
    /* Accessible focus emphasis */
    box-shadow:
      0 0 0 2px rgba(var(--primary-purple-rgb), 0.25),
      0 8px 24px rgba(0, 0, 0, 0.35),
      0 0 36px rgba(var(--primary-purple-rgb), 0.22);
    outline: none;
  }

  @media (prefers-reduced-motion: reduce) {
    .panel-cockpit,
    .panel-cockpit:hover {
      transition: none;
      transform: none;
    }
  }
  
  /* Lower Deck / Engine Bay headers - subtle neon header bar */
  .panel-cockpit[data-panel-id="environment"] > div:first-child,
  .panel-v2[data-panel-id="environment"] > div:first-child,
  .panel-cockpit[data-panel-id="posture-tracker"] > div:first-child,
  .panel-v2[data-panel-id="posture-tracker"] > div:first-child,
  .panel-cockpit[data-panel-id="flow-music"] > div:first-child,
  .panel-v2[data-panel-id="flow-music"] > div:first-child,
  .panel-cockpit[data-panel-id="deck-b"] > div:first-child,
  .panel-v2[data-panel-id="deck-b"] > div:first-child {
    background: linear-gradient(90deg, rgba(var(--primary-purple-rgb), 0.10), rgba(16,185,129,0.06) 40%, rgba(59,130,246,0.05));
    border-bottom: 1px solid rgba(var(--primary-purple-rgb), 0.14);
    box-shadow: inset 4px 0 0 rgba(var(--primary-purple-rgb), 0.25);
  }

  /* Remove any visual underline/rail on headers for all panels except Mission Board and System Log */
  .panel-v2:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:first-child,
  .panel-cockpit:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:first-child {
    border: none !important;
    border-bottom: none !important;
    box-shadow: none !important;         /* remove inset rail/shadow dividers */
    background: transparent !important;  /* remove gradient header bars */
    background-image: none !important;
  }

  /* Ensure no decorative divider under headers for most panels */
  .panel-v2:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:first-child.panel-divider::after,
  .panel-cockpit:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:first-child.panel-divider::after {
    display: none !important;
  }

  /* Remove any underline from subtitle rows and nested elements in headers for most panels */
  .panel-v2:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:first-child *,
  .panel-cockpit:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:first-child * {
    border: none !important;
    text-decoration: none !important;
    box-shadow: none !important;
    background: transparent !important;
  }

  /* Remove section separators (border-t / border-b) inside panel content for most panels */
  .panel-v2:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:nth-child(2) [class*="border-t"],
  .panel-cockpit:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:nth-child(2) [class*="border-t"] {
    border-top: 0 !important;
    border-top-color: transparent !important;
  }
  .panel-v2:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:nth-child(2) [class*="border-b"],
  .panel-cockpit:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:nth-child(2) [class*="border-b"] {
    border-bottom: 0 !important;
    border-bottom-color: transparent !important;
  }
  .panel-v2:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:nth-child(2) hr,
  .panel-cockpit:not([data-panel-id="mission-board"]):not([data-panel-id="system-log"]) > div:nth-child(2) hr {
    display: none !important;
  }

  /* Neon glow pulse animation */
  @keyframes neon-pulse {
    0%, 100% {
      opacity: 1;
      filter: brightness(1) saturate(1);
    }
    50% {
      opacity: 0.9;
      filter: brightness(1.2) saturate(1.2);
    }
  }

  /* HERO glow for the whole timer module */
  .glow-hero {
    /* same radius as our cards */
    border-radius: 16px; /* rounded-2xl equivalent */
    /* neon purple-blue base */
    border: 2px solid rgba(147, 51, 234, 0.40);  /* purple-600 */
    box-shadow:
      0 0 0 1px rgba(147, 51, 234, 0.20) inset,
      0 8px 24px rgba(0, 0, 0, 0.45),
      0 0 30px rgba(147, 51, 234, 0.35),
      0 0 60px rgba(59, 130, 246, 0.25);  /* blue-500 glow */
    animation: neon-pulse 3s ease-in-out infinite;
  }

  /* Streak intensity variants - Neon purple to blue gradient */
  .glow-hero--s1 {
    border: 2px solid rgba(147, 51, 234, 0.70);  /* brighter purple */
    box-shadow:
      0 0 0 2px rgba(168, 85, 247, 0.40) inset,  /* purple-500 */
      0 0 0 5px rgba(147, 51, 234, 0.20),
      0 10px 28px rgba(0, 0, 0, 0.50),
      0 0 40px rgba(168, 85, 247, 0.45),
      0 0 80px rgba(96, 165, 250, 0.30);  /* blue-400 */
    animation: neon-pulse 2.5s ease-in-out infinite;
  }

  .glow-hero--s2 {
    border: 3px solid rgba(168, 85, 247, 0.85);  /* purple-500 */
    box-shadow:
      0 0 0 2px rgba(168, 85, 247, 0.60) inset,
      0 0 0 6px rgba(147, 51, 234, 0.30),
      0 0 0 10px rgba(96, 165, 250, 0.15),  /* blue-400 */
      0 12px 32px rgba(0, 0, 0, 0.52),
      0 0 50px rgba(168, 85, 247, 0.55),
      0 0 100px rgba(59, 130, 246, 0.35);  /* blue-500 */
    animation: neon-pulse 2.2s ease-in-out infinite;
  }

  .glow-hero--s3 {
    border: 3px solid rgba(168, 85, 247, 0.95);  /* strong purple */
    box-shadow:
      0 0 0 3px rgba(196, 181, 253, 0.70) inset,  /* purple-300 */
      0 0 0 7px rgba(168, 85, 247, 0.40),
      0 0 0 12px rgba(59, 130, 246, 0.25),  /* blue-500 */
      0 14px 38px rgba(0, 0, 0, 0.55),
      0 0 60px rgba(168, 85, 247, 0.65),
      0 0 120px rgba(96, 165, 250, 0.40);  /* blue-400 */
    animation: neon-pulse 2s ease-in-out infinite;
  }

  .glow-hero--s4 {
    border: 4px solid rgba(196, 181, 253, 1.0);  /* purple-300 full opacity */
    box-shadow:
      0 0 0 3px rgba(196, 181, 253, 0.80) inset,
      0 0 0 8px rgba(168, 85, 247, 0.50),  /* purple-500 */
      0 0 0 14px rgba(96, 165, 250, 0.35),  /* blue-400 */
      0 0 0 20px rgba(59, 130, 246, 0.20),  /* blue-500 */
      0 16px 44px rgba(0, 0, 0, 0.60),
      0 0 80px rgba(196, 181, 253, 0.70),
      0 0 160px rgba(96, 165, 250, 0.50),
      0 0 220px rgba(59, 130, 246, 0.30);
    animation: neon-pulse 1.8s ease-in-out infinite;
  }

  .glow-hero--s5 {
    border: 4px solid transparent;
    background: linear-gradient(90deg, #c4b5fd, #93c5fd, #c4b5fd) border-box;  /* animated gradient border */
    background-size: 200% 100%;
    box-shadow:
      0 0 0 4px rgba(196, 181, 253, 0.90) inset,  /* purple-300 */
      0 0 0 10px rgba(168, 85, 247, 0.60),  /* purple-500 */
      0 0 0 16px rgba(147, 197, 253, 0.45),  /* blue-300 */
      0 0 0 24px rgba(96, 165, 250, 0.30),  /* blue-400 */
      0 0 0 32px rgba(59, 130, 246, 0.15),  /* blue-500 */
      0 20px 52px rgba(0, 0, 0, 0.65),
      0 0 100px rgba(196, 181, 253, 0.80),
      0 0 200px rgba(147, 197, 253, 0.60),
      0 0 300px rgba(96, 165, 250, 0.40),
      0 0 400px rgba(59, 130, 246, 0.20);
    animation: neon-pulse 1.5s ease-in-out infinite, gradient-shift 3s linear infinite;
  }

  @keyframes gradient-shift {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
  }

  /* Temporary debug outline for verification */
  .debug-ui .panel-glass {
    outline: 2px solid #8B5CF6 !important; /* violet */
  }
}

@layer utilities {
  /* Animation for toast notifications */
  .animate-fade-in-scale {
    animation: fade-in-scale 0.3s ease-out forwards;
  }
  
  @keyframes fade-in-scale {
    from { 
      opacity: 0; 
      transform: translateY(20px) translateX(-50%); 
    }
    to { 
      opacity: 1; 
      transform: translateY(0) translateX(-50%); 
    }
  }
  
  /* Line paper background for notepad */
  .bg-size-100\%-1\.5rem {
    background-size: 100% 1.5rem;
  }

  /* Improved thrust shake animation - reduced displacement to prevent edge artifacts */
  @keyframes thrustShake {
    0% { transform: translate(0, 0) scale(1.001); }
    10% { transform: translate(-0.7px, -0.7px) scale(1.001); }
    20% { transform: translate(0.7px, -0.3px) scale(1.001); }
    30% { transform: translate(-0.3px, 0.7px) scale(1.001); }
    40% { transform: translate(0.3px, -0.3px) scale(1.001); }
    50% { transform: translate(-0.3px, 0.7px) scale(1.001); }
    60% { transform: translate(-0.7px, 0.3px) scale(1.001); }
    70% { transform: translate(0.7px, 0.3px) scale(1.001); }
    80% { transform: translate(-0.3px, -0.3px) scale(1.001); }
    90% { transform: translate(0.3px, 0.7px) scale(1.001); }
    100% { transform: translate(0, 0) scale(1.001); }
  }

  .thrust-shake {
    animation: thrustShake 0.15s cubic-bezier(.36,.07,.19,.97) both;
    transform-origin: center;
    background-color: black !important; /* Force black background during shake */
    overflow: hidden; /* Hide any overflow during animation */
    outline: 1px solid black; /* Add outline to prevent edge artifacts */
  }

  /* Subtle terminal scanlines (used on System Log scroll area) */
  .terminal-gridlines::before {
    content: "";
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(16,185,129,0.035) 2px,
      rgba(16,185,129,0.035) 4px
    );
    pointer-events: none;
  }

  /* Optional shimmer for primary buttons (used by Add / Start Goal) */
  .btn-shimmer::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
    transform: translateX(-100%);
    transition: transform 300ms ease-out;
  }
  .btn-shimmer:hover::before { transform: translateX(100%); }

  /* Subtle purple radial glow behind timer digits (contained within column) */
  .digit-glow { position: relative; overflow: hidden; }
  .digit-glow::before {
    content: "";
    position: absolute;
    inset: 12%; /* shrink so the fade ends before column edges */
    background: radial-gradient(52% 52% at 50% 50%, rgba(var(--primary-purple-rgb), 0.10) 0%, rgba(var(--primary-purple-rgb), 0.06) 30%, rgba(0,0,0,0) 52%);
    filter: blur(6px);
    pointer-events: none;
    z-index: 0;
  }

  /* Keep number input arrows visible but remove their white background in Chromium */
  .no-spin-bg { color-scheme: dark; appearance: textfield; -moz-appearance: textfield; }
  .no-spin-bg::-webkit-inner-spin-button,
  .no-spin-bg::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
    background: transparent;
    border: none;
  }
}